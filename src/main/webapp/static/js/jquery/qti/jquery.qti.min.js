(function(v){function w(b,d,e){b.on("click",function(g,q){g=jQuery(this);g.hasClass("oo-choosed")||g.hasClass("oo-selected")||g.addClass("oo-selected")}).draggable({containment:"#"+d,scroll:!1,revert:"invalid",stop:function(g,q){jQuery(this).css({left:"0px",top:"0px"});jQuery(q.helper).removeClass("oo-drag")},helper:function(){var g=jQuery(this);if(!(0<g.parent(".association_box").length)&&t(this,d))return g.removeClass("oo-selected"),g=g.clone(),jQuery(g).attr("id","n"+l()).data("qti-cloned","true").addClass("oo-drag"),
g;g.addClass("oo-drag");return g}}).on("click",{formId:e.formDispatchFieldId},setFlexiFormDirtyByListener)}function t(b,d){var e=jQuery(b);b=e.data("qti-match-max");e=e.data("qti-id");d=jQuery("#"+d+"_panel div[data-qti-id\x3d'"+e+"']").length;return 0==b||d+1<b}function p(b,d,e){b.on("click",function(g,q){var r=jQuery(this);1==jQuery(".o_associate_item",this).length?jQuery(".o_associate_item",this).each(function(k,x){m(x,r,d)}):jQuery("#"+d+"_items .o_associate_item.oo-selected").each(function(k,
x){k=jQuery(x);t(x,d)?(k.removeClass("oo-selected"),h(k.clone(),r,d)):h(k,r,d)});f(d,e);setFlexiFormDirty(e.formDispatchFieldId,!1)}).droppable({drop:function(g,q){var r=jQuery(this);0<jQuery(".o_associate_item",this).length&&jQuery(".o_associate_item",this).each(function(k,x){m(x,r,d)});null!=q.helper&&"true"==jQuery(q.helper).data("qti-cloned")?(g=jQuery(q.draggable),g.removeClass("oo-selected").removeClass("oo-drag"),g=g.clone(),w(g,d,e)):(g=jQuery(q.draggable),g.removeClass("oo-selected").removeClass("oo-drag"));
h(g,r,d);f(d,e);setFlexiFormDirty(e.formDispatchFieldId,!1)}}).on("click",{formId:e.formDispatchFieldId},setFlexiFormDirtyByListener)}function h(b,d,e){b.removeClass("oo-selected").css({left:"0px",top:"0px"}).addClass("oo-choosed").appendTo(d);d.addClass("oo-filled")}function m(b,d,e){d.removeClass("oo-filled");b=jQuery(b);b.removeClass("oo-choosed");d=b.data("qti-id");0==jQuery("#"+e+"_items div[data-qti-id\x3d'"+d+"']").length?b.appendTo(jQuery("#"+e+"_items")):b.remove()}function l(){function b(){return Math.floor(65536*
(1+Math.random())).toString(16).substring(1)}return b()+b()+b()+b()+b()+b()+b()}function f(b,d){var e=jQuery("#"+b+"_panel");e.find("input[type\x3d'hidden']").remove();jQuery("#"+b+"_panel .association").each(function(g,q){g=jQuery(q).find(".o_associate_item");2==g.length?(q=jQuery(g.get(0)).data("qti-id"),g=jQuery(g.get(1)).data("qti-id"),q=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+d.responseIdentifier).attr("value",q+" "+g),e.prepend(q)):0==g.length&&d.unrestricted?
q.remove():jQuery(q).find(".association_box").each(function(r,k){0==jQuery(k).find(".o_associate_item").length&&jQuery(k).hasClass("oo-filled")&&jQuery(k).removeClass("oo-filled")})});a(b,d)}function a(b,d){if(d.unrestricted&&d.opened){jQuery("#"+b+"_panel");var e=!0;jQuery("#"+b+"_panel .association").each(function(q,r){2!=jQuery(r).find(".o_associate_item").length&&(e=!1)});if(e){var g=c(b,d);g=jQuery("#"+g+" .association_box");p(g,b,d)}}}function c(b,d){d=l();var e='\x3cdiv id\x3d"'+d+'" class\x3d"association" style\x3d""\x3e\n  \x3cdiv class\x3d"association_box left" style\x3d"width: 100px; height:50px; float:left;"\x3e\x3c/div\x3e\n  \x3cdiv class\x3d"association_box right" style\x3d"width: 100px; height:50px; float:right;"\x3e\x3c/div\x3e\n  \x3cdiv style\x3d"clear:both; "\x3e\x3c/div\x3e\n\x3c/div\x3e\n';
jQuery("#"+b+"_panel").append(e);jQuery("#"+b+"_panel").append('\x3cdiv style\x3d"clear:both; "\x3e\x3c/div\x3e\n');return d}v.fn.associateInteraction=function(b){b=v.extend({responseIdentifier:null,formDispatchFieldId:null,responseValue:null,opened:!1,unrestricted:!1},b);try{if("undefined"!=typeof b.responseValue&&0<b.responseValue.length){for(var d=this.attr("id"),e=b.responseValue.split(","),g=jQuery("#"+d+"_panel .association"),q=0;q<e.length;q++){var r=e[q].split(" "),k=jQuery(g.get(q));if(0==
k.length){var x=c(d,b);k=jQuery("#"+x)}var y=jQuery("#"+d+"_items div[data-qti-id\x3d'"+r[0]+"']");t(y,d)&&(y=jQuery(y).clone());var z=jQuery("#"+d+"_items div[data-qti-id\x3d'"+r[1]+"']");t(z,d)&&(z=jQuery(z).clone());jQuery(y).addClass("oo-choosed");jQuery(z).addClass("oo-choosed");jQuery(k.find(".association_box.left")).addClass("oo-filled").append(y);jQuery(k.find(".association_box.right")).addClass("oo-filled").append(z)}f(d,b);b.unrestricted&&b.opened&&a(d,b)}if(b.opened){var C=this.attr("id"),
B=jQuery("#"+C+" .o_associate_item");w(B,C,b);var n=jQuery("#"+C+"_panel .association_box");p(n,C,b)}}catch(u){window.console&&console.log(u)}return this}})(jQuery);
(function(v){function w(p,h){jQuery("#qti_container_"+h.responseIdentifier+" input[type\x3dcheckbox]").on("click",function(m,l){t(h)})}function t(p){var h=jQuery("#qti_container_"+p.responseIdentifier+" input[type\x3dcheckbox]"),m=0;h.each(function(l,f){f.checked&&m++});m>=p.maxChoices?h.each(function(l,f){f.disabled=f.checked?!1:!0}):h.each(function(l,f){f.disabled=!1})}v.fn.choiceInteraction=function(p){p=v.extend({responseIdentifier:null,formDispatchFieldId:null,maxChoices:0},p);try{0<p.maxChoices&&
(w(this,p),t(p))}catch(h){window.console&&console.log(h)}return this}})(jQuery);
(function(v){function w(f,a,c){var b=a.value,d=b.split(" ");c(f,a,b,f.gapChoiceMap[d[0]],f.gapMap[d[1]])}function t(f,a){if(a.opened)p(a.responseIdentifier).on("click",function(){l(a,this);setFlexiFormDirty(a.formDispatchFieldId)});h(a);m(a)}function p(f){return jQuery("input[name\x3dqtiworks_response_"+f+"]")}function h(f){f.matchCount=0;for(var a in f.gapChoiceMap)f.gapChoiceMap[a].matchCount=0;for(a in f.gapMap)f.gapMap[a].matched=!1,f.gapMap[a].matchedGapChoice=null;p(f.responseIdentifier).each(function(b,
d){w(f,this,function(e,g,q,r,k){g.checked&&(r.matchCount++,k.matched=!0,k.matchedGapChoice=r,e.matched[q]=!0)})});for(a in f.gapMap){var c=f.gapMap[a];c.query.text(c.matched?c.matchedGapChoice.text:c.label)}}function m(f){p(f.responseIdentifier).each(function(){w(f,this,function(a,c,b,d,e){c.disabled=a.opened?c.checked?!1:e.matched||0!=d.matchMax&&d.matchCount>=d.matchMax?!0:!1:!0})})}function l(f,a){w(f,a,function(c,b,d,e,g){b.checked?(g.matched||0!=e.matchMax&&e.matchMax<=e.matchCount?b.checked=
!1:(e.matchCount++,g.matched=!0,g.matchedGapChoice=e),g.query.text(e.text)):(e.matchCount--,g.matched=!1,g.matchedGapChoice=null,g.query.text(g.label));m(c)})}v.fn.gapMatchInteraction=function(f){f=v.extend({responseIdentifier:null,formDispatchFieldId:null,gapChoiceData:{},gapData:{},opened:!1,gapChoiceMap:{},gapMap:{},matched:{}},f);for(var a in f.gapChoiceData){var c=jQuery("#qtiworks_id_"+f.responseIdentifier+"_"+a);f.gapChoiceMap[a]={matchMax:f.gapChoiceData[a],matchCount:0,query:c,text:c.text()}}for(a in f.gapData)c=
jQuery("#qtiworks_id_"+f.responseIdentifier+"_"+a),f.gapMap[a]={required:f.gapData[a],matched:!1,matchedGapChoice:null,query:c,label:c.text()};try{t(this,f)}catch(b){window.console&&console.log(b)}return this}})(jQuery);
(function(v){function w(h,m,l){var f=h.attr("id");jQuery("#"+f+"_container area").on("click",function(a){a=jQuery("#"+f+"_container").data("openolat")||{};void 0==a.listOfPairs&&(a.currentSpot="",a.listOfPairs=[],jQuery("#"+f+"_container").data("openolat",a));var c=jQuery(this).data("qti-id");""==a.currentSpot||a.currentSpot==c?a.currentSpot=c:(a.listOfPairs.push([a.currentSpot,c]),a.currentSpot="");var b=document.getElementById(f+"_canvas");c=b.getContext("2d");c.clearRect(0,0,jQuery(b).width(),
jQuery(b).height());b=jQuery("#"+f+"_container");b.find("input[type\x3d'hidden']").remove();var d=[];""!=a.currentSpot&&(t(c,"ac_"+l+"_"+a.currentSpot),d.push(a.currentSpot));for(var e=a.listOfPairs.length;0<e--;){for(var g=a.listOfPairs[e],q=g.length;0<q--;)0>d.indexOf(g[q])&&(t(c,"ac_"+l+"_"+g[q]),d.push(g[q]));q=jQuery("#ac_"+l+"_"+g[1]);g=jQuery("#ac_"+l+"_"+g[0]);var r=p(q),k=p(g);c.beginPath();c.moveTo(r[0],r[1]);c.lineTo(k[0],k[1]);c.lineWidth=3;c.stroke();q=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name",
"qtiworks_response_"+l).attr("value",g.data("qti-id")+" "+q.data("qti-id"));b.prepend(q)}})}function t(h,m){jQuery("#"+m).each(function(l,f){f=jQuery(f);l=p(f);f=f.attr("shape");var a;var c=a=0;h.beginPath();if("rect"==f)h.rect(l[0]+a,l[1]+c,l[2]-l[0],l[3]-l[1]);else if("poly"==f)for(h.moveTo(l[0]+a,l[1]+c),i=2;i<l.length;i+=2)h.lineTo(l[i]+a,l[i+1]+c);else"circ"!=f&&"circle"!=f||h.arc(l[0]+a,l[1]+c,l[2]-2,0,2*Math.PI,!1);h.closePath();h.lineWidth=4;h.strokeStyle="#003300";h.stroke();h.fillStyle=
"green";h.fill()})}function p(h){h=h.attr("coords").split(",");for(i=h.length;0<i--;)h[i]=parseFloat(h[i]);return h}v.fn.graphicAssociateInteraction=function(h){h=v.extend({responseIdentifier:null,formDispatchFieldId:null,responseValue:null,maxAssociations:1,opened:!1},h);try{if("undefined"!==typeof h.responseValue&&0<h.responseValue.length){var m=h.responseValue,l=h.responseIdentifier,f=this.attr("id"),a=jQuery("#"+f+"_container"),c=document.getElementById(f+"_canvas"),b=c.getContext("2d");b.clearRect(0,
0,jQuery(c).width(),jQuery(c).height());f=[];for(var d=m.split(","),e=d.length;0<e--;){for(var g=d[e].split(" "),q=g.length;0<q--;)0>f.indexOf(g[q])&&(t(b,"ac_"+l+"_"+g[q]),f.push(g[q]));if(2==g.length){var r=jQuery("#ac_"+l+"_"+g[1]),k=jQuery("#ac_"+l+"_"+g[0]),x=p(r),y=p(k);b.beginPath();b.moveTo(x[0],x[1]);b.lineTo(y[0],y[1]);b.lineWidth=3;b.stroke();var z=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+l).attr("value",k.data("qti-id")+" "+r.data("qti-id"));a.prepend(z)}}}h.opened&&
w(this,h.maxAssociations,h.responseIdentifier)}catch(C){window.console&&console.log(C)}return this}})(jQuery);
(function(v){function w(h,m){var l=h.attr("id");jQuery(".gap_item").on("click",function(f,a){f=jQuery(this);if(f.hasClass("oo-choosed"))if(a=f.data("drop-timestamp"),"undefined"!==typeof a&&null!=a&&1500>Date.now()-a)f.data("drop-timestamp",null);else{f.removeClass("oo-choosed");var c=f.data("qti-id");jQuery("#"+l).find("input[type\x3d'hidden']").each(function(b,d){0==jQuery(d).val().indexOf(c+" ")&&jQuery(d).remove()});f.css({position:"relative",left:"0px",top:"0px"})}else f.addClass("oo-selected")}).draggable({containment:"#"+
l,scroll:!1,revert:"invalid",stop:function(f,a){jQuery(this).hasClass("oo-choosed")||jQuery(this).css({position:"relative",left:"0px",top:"0px"})}}).mousemove(function(f,a){a=jQuery(this);if(a.hasClass("ui-draggable-dragging")){var c=jQuery("#"+l+"_img").offset(),b=a.offset();f=b.left+a.width()/2-c.left;a=b.top+a.height()/2-c.top;var d=t(f,a,l);"invalid"!=d?(jQuery("#"+l+" area").each(function(e,g){e=jQuery(g);g=e.attr("id");d==g?e.mouseover():e.mouseout()}),jQuery("#"+d).mouseover()):jQuery("#"+
l+" area").each(function(e,g){jQuery(g).mouseout()})}});jQuery("#"+l).droppable({drop:function(f,a){f=jQuery("#"+l+"_img").offset();a=jQuery(a.draggable);var c=a.offset(),b=c.left+a.width()/2-f.left;f=c.top+a.height()/2-f.top;f=t(b,f,l);if("invalid"!=f){f=jQuery("#"+f);b=p(f);c=f.data("qti-id");var d=a.data("qti-id");a.css("position","absolute");a.css("left",b[0]+"px");a.css("top",b[1]+"px");a.css("border","none");a.removeClass("oo-selected");a.addClass("oo-choosed");b=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name",
"qtiworks_response_"+m.responseIdentifier).attr("value",d+" "+c);jQuery(this).prepend(b);jQuery(f).mouseout();a.data("drop-timestamp",Date.now())}}});jQuery("#"+l+" area").on("click",function(f,a){var c=jQuery(this);jQuery(".gap_item.oo-selected").each(function(b,d){var e=jQuery(d),g=p(c);b=c.data("qti-id");d=e.data("qti-id");e.css("position","absolute");e.css("left",g[0]+"px");e.css("top",g[1]+"px");e.css("border","none");e.removeClass("oo-selected");e.addClass("oo-choosed");e=jQuery("#"+l);b=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name",
"qtiworks_response_"+m.responseIdentifier).attr("value",d+" "+b);e.prepend(b)})})}function t(h,m,l){var f="invalid";jQuery("#"+l+" area").each(function(a,c){c=jQuery(c);a=c.attr("id");c.attr("coords");var b=c.attr("shape");c=p(c);if("circle"==b)Math.pow(c[2],2)>=Math.pow(h-c[0],2)+Math.pow(m-c[1],2)&&(f=a);else if("rect"==b)c=c[0]<=h&&h<=c[2]&&c[1]<=m&&m<=c[3]?!0:!1,c&&(f=a);else if("poly"==b){a={x:[],y:[]};b=c.length/2;var d=0;for(ix=0;ix<b;ix++)a.x[ix]=c[d],a.y[ix]=c[d+1],d+=2;for(i=0;i<a.length;i++){d=
a.x.length;var e=a.x,g=a.y,q=!1;b=0;for(c=d-1;b<d;c=b++)g[b]>m!=g[c]>m&&h<(e[c]-e[b])*(m-g[b])/(g[c]-g[b])+e[b]&&(q=!q);if(q){f=a.id;break}}}});return f}function p(h){h=h.attr("coords").split(",");for(i=h.length;0<i--;)h[i]=parseFloat(h[i]);return h}v.fn.graphicGapInteraction=function(h){h=v.extend({maphilight:null,responseIdentifier:null,formDispatchFieldId:null,responseValue:null,opened:!1},h);try{if("undefined"!==typeof h.responseValue&&0<h.responseValue.length)for(var m=this.attr("id"),l=jQuery("#"+
m),f=h.responseValue.split(","),a=f.length;0<a--;){var c=f[a].split(" "),b=jQuery("#ac_"+h.responseIdentifier+"_"+c[0]),d=jQuery("#ac_"+h.responseIdentifier+"_"+c[1]);if(b.hasClass("gap_item")){var e=b;var g=d}else e=d,g=b;var q=p(g);e.css("position","absolute");e.css("left",q[0]+"px");e.css("top",q[1]+"px");e.addClass("oo-choosed");var r=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+h.responseIdentifier).attr("value",e.data("qti-id")+" "+g.data("qti-id"));l.prepend(r)}h.opened&&
w(this,h)}catch(k){window.console&&console.log(k)}return this}})(jQuery);
(function(v){function w(t,p){var h=t.attr("id");jQuery("#"+h+"_container area").on("click",function(m){var l=jQuery(this).attr("id"),f=jQuery(this).data("qti-id");m=jQuery(this).attr("coords").split(",");var a=m[0],c=m[1];m=jQuery("#"+h+"_container").data("openolat")||{};void 0==m.listOfPoints&&(m.listOfPoints=[],jQuery("#"+h+"_container").data("openolat",m));for(var b=!1,d=[],e=m.listOfPoints.length;0<e--;){var g=m.listOfPoints[e];64>(g.x-a)*(g.x-a)+(g.y-c)*(g.y-c)?b=!0:d.push(g)}if(b)m.listOfPoints=
d;else{if(m.listOfPoints.length>=p.maxChoices)return!1;m.listOfPoints.push({x:a,y:c,areaId:l,spotQtiId:f})}e=document.getElementById(h+"_canvas");l=e.getContext("2d");l.clearRect(0,0,jQuery(e).width(),jQuery(e).height());f=jQuery("#"+h+"_container");f.find("input[type\x3d'hidden']").remove();for(e=m.listOfPoints.length;0<e--;)g=m.listOfPoints[e],l.font="16px Arial",l.fillText(""+(e+1),g.x,g.y),g=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+p.responseIdentifier).attr("value",
g.spotQtiId),f.prepend(g)})}v.fn.graphicOrderInteraction=function(t){t=v.extend({responseIdentifier:null,formDispatchFieldId:null,responseValue:null,maxChoices:1,opened:!1},t);try{if("undefined"!==typeof t.responseValue&&0<t.responseValue.length){var p=this.attr("id"),h=jQuery("#"+p+"_container"),m=document.getElementById(p+"_canvas"),l=m.getContext("2d");l.clearRect(0,0,jQuery(m).width(),jQuery(m).height());for(var f=t.responseValue.split(","),a=f.length;0<a--;)if(0!=f[a].length){var c=jQuery("#ac_"+
t.responseIdentifier+"_"+f[a]),b=c.data("qti-id"),d=c.attr("coords").split(","),e=d[0],g=d[1];l.font="16px Arial";l.fillText(""+(a+1),e,g);var q=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+t.responseIdentifier).attr("value",b);h.prepend(q)}}t.opened&&w(this,t)}catch(r){window.console&&console.log(r)}return this}})(jQuery);
(function(v){function w(h,m){var l=h.attr("id");jQuery("#"+l+" map area").each(function(f,a){jQuery(a).on("click",function(){t(this,l,m.responseIdentifier,m.maxChoices,m.singleChoice,m.maphilightSettings)})})}function t(h,m,l,f,a,c){h=jQuery(h);var b=h.data("maphilight")||{};if("undefined"===typeof b.selectedOn||!b.selectedOn)if(a&&jQuery("area","map[name\x3d'"+m+"_map']").each(function(g,q){g=jQuery(q).data("maphilight")||{};g.selectedOn&&(g.selectedOn=!1,p(g,c),jQuery(q).data("maphilight",g).trigger("alwaysOn.maphilight"))}),
0<f){var d=0;jQuery("area","map[name\x3d'"+m+"_map']").each(function(g,q){(jQuery(q).data("maphilight")||{}).selectedOn&&d++});if(d>=f)return!1}b.selectedOn="undefined"===typeof b.selectedOn?!0:!b.selectedOn;p(b,c);h.data("maphilight",b).trigger("alwaysOn.maphilight");var e=jQuery("#"+m);e.find("input[type\x3d'hidden']").remove();jQuery("area","map[name\x3d'"+m+"_map']").each(function(g,q){g=jQuery(q);(g.data("maphilight")||{}).selectedOn&&(g=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name",
"qtiworks_response_"+l).attr("value",g.data("qti-id")),e.append(g))})}function p(h,m){h.selectedOn?(h.fillColor=m.selectedFillColor,h.fillOpacity=m.selectedFillOpacity,h.strokeColor=m.selectedStrokeColor,h.strokeOpacity=m.selectedStrokeOpacity,h.shadow=m.selectedShadow,h.shadowX=0,h.shadowY=0,h.shadowRadius=7,h.shadowColor="000000",h.shadowOpacity=.8,h.shadowPosition="outside"):(h.fillColor=m.fillColor,h.fillOpacity=m.fillOpacity,h.strokeColor=m.strokeColor,h.strokeOpacity=m.strokeOpacity,h.shadow=
!1)}v.fn.hotspotInteraction=function(h){h=v.extend({responseIdentifier:null,formDispatchFieldId:null,maxChoices:1,singleChoice:!1,responseValue:null,opened:!1,maphilightSettings:{}},h);try{if("undefined"!==typeof h.responseValue&&0<h.responseValue.length)for(var m=this.attr("id"),l=jQuery("#"+m),f=h.responseValue.split(","),a=f.length;0<a--;){var c=jQuery("#ac_"+h.responseIdentifier+"_"+f[a]),b=c.data("maphilight")||{};b.selectedOn=!0;p(b,h.maphilightSettings);c.data("maphilight",b).trigger("alwaysOn.maphilight");
var d=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+h.responseIdentifier).attr("value",c.data("qti-id"));l.append(d)}h.opened&&w(this,h)}catch(e){window.console&&console.log(e)}return this}})(jQuery);
(function(v){v.fn.rwdImageMaps=function(w){var t=v.extend({fillColor:"bbbbbb",fillOpacity:.5,strokeColor:"6E6E6E",strokeOpacity:1},w),p=this,h=null,m=0,l=0;w=function(){p.each(function(){if("undefined"!=typeof v(this).attr("usemap")){var f=function(b,d){v("\x3cimg /\x3e").on("load",function(){d.data("width")||d.data("width",d.attr("width"));d.data("height")||d.data("height",d.attr("height"));var e=d.data("width"),g=d.data("height");if(!e||!g){var q=new Image;q.src=d.attr("src");e||(e=q.width,d.data("width",
g));g||(g=q.height,d.data("height",g))}q=d.closest(".o_oo_hotcontainer").width();var r=d.width(),k=d.height();q<e?(r=q,k=g/e*q|0,d.width(r),d.height(k)):0==r&&0==k&&(r=e,k=g,d.width(r),d.height(k));var x=r/100,y=k/100;q=d.attr("usemap").replace("#","");v('map[name\x3d"'+q+'"]').find("area").each(function(){var z=v(this);z.data("coords")||z.data("coords",z.attr("coords"));for(var C=z.data("coords").split(","),B=Array(C.length),n=0;n<B.length;++n)B[n]=0===n%2?parseInt(C[n]/e*100*x):parseInt(C[n]/g*
100*y);z.attr("coords",B.toString())});h=!0;d.maphilight({fillColor:t.fillColor,fillOpacity:t.fillOpacity,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWidth:3,alwaysOn:!0})}).attr("src",d.attr("src"))},a=v(this),c=a.closest(".o_oo_hotcontainer").width();if(h){if(m!=window.innerWidth||l!=c)f(this,a),m=window.innerWidth,l=c}else m=window.innerWidth,l=c,f(this,a)}})};v(window).resize(w).trigger("resize");v(p).closest(".o_qti21_collapsable_solution").on("shown.bs.collapse",w);return this}})(jQuery);
(function(v){function w(a,c){t(c.responseIdentifier).on("click",function(){l(c,this)});h(c);m(c)}function t(a){return jQuery("input[name\x3dqtiworks_response_"+a+"]")}function p(a,c,b){var d=c.value,e=d.split(" ");b(c,d,a.leftMap[e[0]],a.rightMap[e[1]])}function h(a){a.matchCount=0;a.matched={};for(var c in a.leftMap)a.leftMap[c].matchCount=0;for(c in a.rightMap)a.rightMap[c].matchCount=0;t(a.responseIdentifier).each(function(){p(a,this,function(b,d,e,g){b.checked&&(a.matchCount++,e.matchCount++,
g.matchCount++,a.matched[d]=!0)})})}function m(a){t(a.responseIdentifier).each(function(){p(a,this,function(c,b,d,e){c.disabled=c.checked?!1:0!=a.maxAssociations&&a.matchCount>=a.maxAssociations?!0:0!=d.matchMax&&d.matchCount>=d.matchMax?1!=d.matchMax&&1!=d.matchCount?!0:!1:0!=e.matchMax&&e.matchCount>=e.matchMax?!0:!1})})}function l(a,c){p(a,c,function(b,d,e,g){if(b.checked){d=!1;if(1==e.matchMax){d=jQuery(b);var q=d.attr("id"),r=d.attr("value").split(" ")[0];t(a.responseIdentifier).each(function(){p(a,
this,function(k,x,y,z){x=jQuery(k);q!==x.attr("id")&&k.checked&&(x=x.attr("value").split(" ")[0],r===x&&(k.checked=!1,y.matchCount--,z.matchCount--,a.matchCount--))})});e.matchCount++;a.matchCount++;d=!0}else 0!=e.matchMax&&e.matchMax<=e.matchCount?b.checked=!1:(e.matchCount++,a.matchCount++,d=!0);0!=g.matchMax&&g.matchMax<=g.matchCount?b.checked=!1:(g.matchCount++,d||a.matchCount++)}else a.matchCount--,e.matchCount--,g.matchCount--;m(a);b.checked||null==a.unansweredColumn||f(a,b)})}function f(a,
c){var b=jQuery(c).attr("value").split(" ")[0],d=0,e=null;t(a.responseIdentifier).each(function(){p(a,this,function(g,q,r,k){q=jQuery(g);r=q.attr("value").split(" ")[0];b===r&&(g.checked?d++:1==q.closest("."+a.unansweredColumn).length&&(e=g))})});0==d&&null!=e&&(e.checked=!0)}v.fn.matchInteraction=function(a){a=v.extend({responseIdentifier:null,formDispatchFieldId:null,maxAssociations:1,unansweredColumn:null,leftData:{},rightData:{},leftMap:{},rightMap:{},matched:[]},a);for(var c in a.leftData)a.leftMap[c]=
{matchMax:a.leftData[c],matchCount:0};for(c in a.rightData)a.rightMap[c]={matchMax:a.rightData[c],matchCount:0};try{w(this,a)}catch(b){window.console&&console.log(b)}return this}})(jQuery);
(function(v){function w(c,b){jQuery("#"+c+" .o_match_dnd_sources").droppable({tolerance:"pointer",over:function(d,e){jQuery(this).addClass("oo-accepted")},out:function(d,e){jQuery(this).removeClass("oo-accepted")},drop:function(d,e){d=jQuery(this);d.removeClass("oo-accepted");e=jQuery(e.draggable);var g=e.data("qti-id");0<d.find("li[data-qti-id\x3d'"+g+"']").length?0==e.parents(".o_match_dnd_sources").length&&e.remove():e.appendTo(d);a(c,b);setFlexiFormDirty(b.formDispatchFieldId,!1)}}).on("click",
{formId:b.formDispatchFieldId},setFlexiFormDirtyByListener)}function t(c,b,d){c.on("click",function(e,g){e=jQuery(this);e.hasClass("oo-choosed")||e.hasClass("oo-selected")?0<e.parents(".o_match_dnd_targets").length&&!e.hasClass("oo-dropped-mrk")&&(f(e,b),a(b,d),setFlexiFormDirty(d.formDispatchFieldId,!1)):(jQuery("#"+b+" .o_match_dnd_sources .o_match_dnd_source").each(function(q,r){jQuery(r).removeClass("oo-selected")}),e.addClass("oo-selected"))}).draggable({containment:"#"+b,scroll:!1,revert:"invalid",
cursorAt:{left:5,top:5},start:function(e,g){jQuery(g.helper).removeClass("oo-dropped-mrk")},stop:function(e,g){jQuery(this).css({left:"0px",top:"0px","z-index":""});jQuery(g.helper).removeClass("oo-drag")},helper:function(){var e=jQuery(this);if(!(0<e.parent(".o_match_dnd_target").length)&&h(this,b)){e.removeClass("oo-selected");var g=e.clone();jQuery(g).attr("id","n"+p()).data("qti-cloned","true").addClass("oo-drag").addClass("oo-drag-mrk").css("z-index",10).css("width",e.width()).css("height",e.height());
return g}e.addClass("oo-drag").addClass("oo-drag-mrk").css("z-index",10);return e}}).on("click",{formId:d.formDispatchFieldId},setFlexiFormDirtyByListener)}function p(){function c(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return c()+c()+c()+c()+c()+c()+c()}function h(c,b){var d=jQuery(c);if(0<d.parents(".o_match_dnd_target").length)return!1;c=d.data("qti-match-max");d=d.data("qti-id");b=jQuery("#"+b+" .o_match_dnd_targets li[data-qti-id\x3d'"+d+"']").length;return 0==
c||b+1<c}function m(c,b,d){c.on("click",function(e,g){var q=this,r=jQuery(q);0==jQuery(".o_associate_item",this).length&&jQuery("#"+b+" .o_match_dnd_sources .oo-selected").each(function(k,x){k=jQuery(x);var y=k.data("qti-id");y=0==jQuery(".o_match_dnd_source[data-qti-id\x3d'"+y+"']",q).length;var z=jQuery(q).data("qti-match-max");0<z&&jQuery(".o_match_dnd_source",q).length>=z&&(y&=0);y&&(h(x,b)?(k.removeClass("oo-selected"),k=k.clone(),l(k,r,b),t(k,b,d)):l(k,r,b))});a(b,d);setFlexiFormDirty(d.formDispatchFieldId,
!1)}).droppable({tolerance:"pointer",accept:function(e){e=jQuery(e).data("qti-id");if(e=0==jQuery(".o_match_dnd_source[data-qti-id\x3d'"+e+"']",this).length){var g=jQuery(this).data("qti-match-max");0<g&&jQuery(".o_match_dnd_source",this).length>=g&&(e=!1)}return e},over:function(e,g){jQuery(this).addClass("oo-accepted")},out:function(e,g){jQuery(this).removeClass("oo-accepted")},drop:function(e,g){e=jQuery(this);e.removeClass("oo-accepted");var q=jQuery(g.draggable),r=q.data("qti-id");0<jQuery(".o_match_dnd_source[data-qti-id\x3d'"+
r+"']",this).length||(null!=g.helper&&"true"==jQuery(g.helper).data("qti-cloned")?(q.removeClass("oo-selected").removeClass("oo-drag"),q=q.clone(),t(q,b,d)):q.removeClass("oo-selected").removeClass("oo-drag"),l(q,e,b),q.addClass("oo-dropped-mrk"),setTimeout(function(){q.removeClass("oo-dropped-mrk")},100),a(b,d),setFlexiFormDirty(d.formDispatchFieldId,!1))}}).on("click",{formId:d.formDispatchFieldId},setFlexiFormDirtyByListener)}function l(c,b,d){d=b.find("ul.o_match_dnd_target_drop_zone");c.removeClass("oo-selected").css({width:"auto",
left:"0px",top:"0px","z-index":""}).addClass("oo-choosed").appendTo(d);b.addClass("oo-filled")}function f(c,b){c=jQuery(c);c.removeClass("oo-choosed");var d=c.data("qti-id");0==jQuery("#"+b+" .o_match_dnd_sources li[data-qti-id\x3d'"+d+"']").length?c.css({width:"auto",left:"0px",top:"0px","z-index":""}).appendTo(jQuery("#"+b+" .o_match_dnd_sources")):c.remove()}function a(c,b){b.matchCount=0;b.matched={};for(var d in b.leftMap)b.leftMap[d].matchCount=0;for(d in b.rightMap)b.rightMap[d].matchCount=
0;var e=jQuery("#"+c);e.find("input[type\x3d'hidden']").remove();jQuery("#"+c+" .o_match_dnd_target_drop_zone").each(function(g,q){jQuery(q).find(".o_match_dnd_source").each(function(r,k){r=jQuery(k).data("qti-id");k=jQuery(q).data("qti-id");r=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+b.responseIdentifier).attr("value",r+" "+k);e.prepend(r)})})}v.fn.matchInteractionDnd=function(c){c=v.extend({responseIdentifier:null,formDispatchFieldId:null,maxAssociations:1,responseValue:null,
opened:!1},c);try{if("undefined"!=typeof c.responseValue&&0<c.responseValue.length){for(var b=this.attr("id"),d=c.responseValue.split(","),e=0;e<d.length;e++){var g=d[e].split(" "),q=g[1],r=jQuery("#"+b+" .o_match_dnd_sources li[data-qti-id\x3d'"+g[0]+"']");h(r,b)&&(r=jQuery(r).clone());var k=jQuery("#"+b+" .o_match_dnd_targets ul[data-qti-id\x3d'"+q+"']");jQuery(r).addClass("oo-choosed");jQuery(k).addClass("oo-choosed");jQuery(k).addClass("oo-filled").append(r);var x=r.attr("data-qti-scores");if(null!=
x&&0<x.length)for(var y=x.split(";"),z=0;z<y.length;z++){var C=y[z];if(0==C.indexOf(q)){var B=C.split("\x3d")[1];r.append("\x3cdiv style\x3d'text-align: right;' class\x3d'o_qti_score_infos'\x3e"+B+"\x3c/div\x3e")}}}a(b,c);c.unrestricted&&c.opened&&addNewAssociationBoxAndEvents(b,c)}if(c.opened){var n=this.attr("id");w(n,c);var u=jQuery("#"+n+" .o_match_dnd_source");t(u,n,c);var A=jQuery("#"+n+" .o_match_dnd_target");m(A,n,c)}}catch(D){window.console&&console.log(D)}return this}})(jQuery);
(function(v){function w(a,c){a="#qtiworks_response_"+c.responseIdentifier;var b=jQuery(a+" div.source \x3e ul"),d=jQuery(a+" div.target \x3e ul"),e=jQuery(a+" div.source \x3e ul").get(0),g=jQuery(a+" div.target \x3e ul").get(0);dragula([e,g],{copy:function(q,r){return!1},accepts:function(q,r){return r!==e}}).on("drag",function(q,r){}).on("over",function(q,r,k){r===g&&jQuery(r).addClass("oo-accepted")}).on("drop",function(q,r,k,x){f(c);setFlexiFormDirty(c.formDispatchFieldId)}).on("dragend",function(q){jQuery(g).removeClass("oo-accepted")}).on("out",
function(q){jQuery(g).removeClass("oo-accepted")});t(b,d);h(b,d,c)}function t(a,c){a.find("li").on("click",function(b,d){p(jQuery(this),a,c)})}function p(a,c,b){a.hasClass("oo-selected")?(l(c,b),b.removeClass("oo-selected")):(l(c,b),a.addClass("oo-selected"),b.addClass("oo-selected"))}function h(a,c,b){c.on("click",function(d,e){d.target===c.get(0)?(d=a.find("li.oo-selected"),0!==d.length&&(d.removeClass("oo-selected"),e=d.clone(),c.append(e),c.removeClass("oo-selected"),d.remove(),f(b))):m(d.target,
a,c)})}function m(a,c,b){a=jQuery(a).closest("li.o_assessmentitem_order_item");if(0<a.length){l(c,b);b.removeClass("oo-selected");var d=a.clone();d.on("click",function(e,g){p(jQuery(this),c,b)});c.append(d);a.remove();f(settings)}}function l(a,c){c.find("li").each(function(b,d){jQuery(d).removeClass("oo-selected")});a.find("li").each(function(b,d){jQuery(d).removeClass("oo-selected")})}function f(a){var c="#qtiworks_response_"+a.responseIdentifier;jQuery(c+" div.source \x3e ul");var b=jQuery(c+" div.target \x3e ul"),
d=jQuery(c+" div.target"),e=jQuery(c+" div.hiddenInputContainer"),g=b.children("li").length;if(null!=a.minChoices&&null!=a.maxChoices){if(g<a.minChoices||g>a.maxChoices)return a.minChoices!=a.maxChoices?alert("You must select and order between "+a.minChoices+" and "+a.maxChoices+" items"):alert("You must select and order exactly "+a.minChoices+" item"+(1<minChoices?"s":"")),d.toggleClass("highlight",!0),!1;d.toggleClass("highlight",!1)}e=jQuery(c+" div.hiddenInputContainer");e.empty();b.children("li").each(function(q){q=
this.id.substring(18);var r=jQuery('\x3cinput type\x3d"hidden"\x3e');r.attr("name","qtiworks_response_"+a.responseIdentifier);r.attr("value",q);e.append(r)})}v.fn.orderInteraction=function(a){a=v.extend({responseIdentifier:null,formDispatchFieldId:null,minChoices:null,maxChoices:null,responseValue:null,opened:!1},a);try{"undefined"!=typeof a.responseValue&&0<a.responseValue.length&&f(a),a.opened&&w(this,a)}catch(c){window.console&&console.log(c)}return this}})(jQuery);
(function(v){function w(p,h){var m=p.attr("id");p=jQuery("#"+m);var l=h.responseValue.split(":");m=jQuery("#"+m+" .items_container .o_item.o_"+h.responseIdentifier);for(var f=l.length;0<f--;){var a=l[f].split(" "),c=a[0];a=a[1];var b=jQuery(m.get(f));b.css("position","absolute");b.css("top",a+"px");b.css("left",c+"px");b="in-"+b.attr("id")+"-"+h.responseIdentifier;c=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("id",b).attr("name","qtiworks_response_"+h.responseIdentifier).attr("value",c+" "+a);
p.prepend(c)}}function t(p,h){var m=p.attr("id"),l=jQuery("#"+m);jQuery("#"+m+" .items_container .o_item.o_"+h.responseIdentifier).draggable({containment:"#"+m,scroll:!1,stop:function(f,a){a=jQuery("#"+m+"_img");f=jQuery(a).offset().top-jQuery(window).scrollTop();a=jQuery(a).offset().left-jQuery(window).scrollLeft();var c=jQuery(this).offset().top-jQuery(window).scrollTop(),b=jQuery(this).offset().left-jQuery(window).scrollLeft();a=Math.round(b-a);f=Math.round(c-f);c="in-"+jQuery(this).attr("id")+
"-"+h.responseIdentifier;b=l.find("#"+c);0==b.length?(f=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("id",c).attr("name","qtiworks_response_"+h.responseIdentifier).attr("value",a+" "+f),l.prepend(f)):b.val(a+" "+f);setFlexiFormDirty(h.formDispatchFieldId)}})}v.fn.positionObjectStage=function(p){p=v.extend({responseIdentifier:null,formDispatchFieldId:null,responseValue:null,maxChoices:1,opened:!1},p);try{var h=this.attr("id");jQuery("#"+h+" .items_container .o_item.o_"+p.responseIdentifier).each(function(m,
l){jQuery(l).attr("id","object-item-"+m)});"undefined"!==typeof p.responseValue&&0<p.responseValue.length&&w(this,p);p.opened&&t(this,p)}catch(m){window.console&&console.log(m)}return this}})(jQuery);
(function(v){function w(t,p){var h=t.attr("id");jQuery("#"+h+"_canvas").on("click",function(m,l){var f=jQuery(this).offset().top-jQuery(window).scrollTop();l=jQuery(this).offset().left-jQuery(window).scrollLeft();l=Math.round(m.clientX-l);var a=Math.round(m.clientY-f);m=jQuery("#"+h).data("openolat")||{};void 0==m.listOfPoints&&(m.listOfPoints=[],jQuery("#"+h).data("openolat",m));var c=!1,b=[];for(i=m.listOfPoints.length;0<i--;)f=m.listOfPoints[i],Math.pow(8,2)>(f.x-l)*(f.x-l)+(f.y-a)*(f.y-a)?c=!0:
b.push(f);if(c)m.listOfPoints=b;else{if(m.listOfPoints.length>=p.maxChoices)return!1;m.listOfPoints.push({x:l,y:a})}f=document.getElementById(h+"_canvas");l=f.getContext("2d");l.clearRect(0,0,jQuery(f).width(),jQuery(f).height());a=jQuery("#"+h);a.find("input[type\x3d'hidden']").remove();for(i=m.listOfPoints.length;0<i--;)f=m.listOfPoints[i],l.beginPath(),l.arc(f.x,f.y,8,0,2*Math.PI,!1),l.stroke(),l.closePath(),f=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+p.responseIdentifier).attr("value",
f.x+" "+f.y),a.append(f);setFlexiFormDirty(p.formDispatchFieldId)})}v.fn.selectPointInteraction=function(t){t=v.extend({responseIdentifier:null,formDispatchFieldId:null,responseValue:null,maxChoices:1,opened:!1},t);try{if("undefined"!==typeof t.responseValue&&0<t.responseValue.length){var p=this.attr("id"),h=jQuery("#"+p),m=t.responseValue.split(":"),l=document.getElementById(p+"_canvas"),f=l.getContext("2d");f.clearRect(0,0,jQuery(l).width(),jQuery(l).height());for(i=m.length;0<i--;)if(0!=m[i].length){var a=
m[i].split(" "),c=a[0],b=a[1];f.beginPath();f.arc(c,b,8,0,2*Math.PI,!1);f.stroke();f.closePath();var d=jQuery('\x3cinput type\x3d"hidden"/\x3e').attr("name","qtiworks_response_"+t.responseIdentifier).attr("value",c+" "+b);h.append(d)}}t.opened&&w(this,t)}catch(e){window.console&&console.log(e)}return this}})(jQuery);
(function(v){function w(t,p){var h=jQuery("#qtiworks_id_slider_"+p.responseIdentifier);t=jQuery('input[name\x3d"qtiworks_response_'+p.responseIdentifier+'"]').get(0).value||p.min;h.slider({value:t,step:p.step,disabled:!p.opened,orientation:p.orientation,min:p.isReversed?-p.max:p.min,max:p.isReversed?-p.min:p.max,slide:function(m,l){m=p.isReversed?-l.value:l.value;l=jQuery("#qtiworks_id_slidervalue_"+p.responseIdentifier);jQuery('input[name\x3d"qtiworks_response_'+p.responseIdentifier+'"]').get(0).value=
m;l.text(m);h.slider("value",p.isReversed?-m:m);setFlexiFormDirty(p.formDispatchFieldId)}})}v.fn.sliderInteraction=function(t){t=v.extend({responseIdentifier:null,formDispatchFieldId:null,responseValue:null,min:1,max:1,step:1,orientation:null,isReversed:!1,isDiscrete:!1,opened:!1,initialValue:null},t);try{w(this,t)}catch(p){window.console&&console.log(p)}return this}})(jQuery);
(function(v){v.fn.qtiCopyPaste=function(w){function t(l){l=l.replace(/\t/g,"");return l=l.replace(/(\r\n|\n|\r)/g,"")}var p=v.extend({errorHeader:null,errorMessage:null},w);w=function(){var l="",f=document.activeElement;"textarea"==(f?f.tagName.toLowerCase():null)&&"number"==typeof f.selectionStart?l=f.value.slice(f.selectionStart,f.selectionEnd):window.getSelection&&(l=document.getSelection().toString());h=l;return!0};var h="",m=document.getElementById(this.attr("id"));m.addEventListener("copy",
w,!1);m.addEventListener("cut",w,!1);m.addEventListener("paste",function(l){var f=l.clipboardData.getData("text");t(f)!==t(h)&&(l.preventDefault(),showMessageBox("warn",p.errorHeader,p.errorMessage));return!0});return this}})(jQuery);
(function(v){v.fn.qtiCountWord=function(w){var t=v.extend({responseUniqueId:null,labelSingular:"xxx word",labelPlural:"xxx words"},w),p=function(a,c){if(1==a.nodeType)if(("SPAN"===a.nodeName||"DIV"===a.nodeName)&&a.classList.contains("math"))c.formulas++;else{if(a.hasChildNodes()){a=a.childNodes;for(var b=a.length;0<b--;)p(a[b],c)}}else 3==a.nodeType&&(a=a.nodeValue.replace(/\u00a0/g," "),c.text+=" "+a)};this.countHtml=function(a){var c=document.createElement("div");c.innerHTML=a;a={text:"",formulas:0};
p(c,a);c=m(a.text);l(c+a.formulas)};var h=function(a){a=m(a);l(a)};this.countText=h;var m=function(a){a=a.match(/[\w\u00C0-\u00ff]+/g);var c=0;if(null!=a)for(var b=a.length;0<b--;)1<a[b].length&&c++;return c},l=function(a){var c=jQuery(f).parent().get(0),b=1<a?t.labelPlural:t.labelSingular;b=b.replace("xxx",""+a);jQuery(".o_qti_essay_num_of_words",c).text(b)},f="#oo_"+t.responseUniqueId;if(!jQuery(f).hasClass("o_richtext_mce"))jQuery("#oo_"+t.responseUniqueId).on("keyup",function(a){a=jQuery(f);h(a.val())});
return this}})(jQuery);
(function(v){v.fn.paintV2=function(t){var p=this.data("data-oo-paint-v2");"undefined"===typeof p&&(p=new w(this,t),this.data("data-oo-paint-v2",p));return p};var w=function(t,p){function h(){try{setFlexiFormDirty(q)}catch(n){window.console&&console.log(n)}}function m(n){l();jQuery(n).addClass("active")}function l(){jQuery("#"+r+" div.o_group_tools a").removeClass("active")}function f(){k.freeDrawingBrush.width=b();k.freeDrawingBrush.color=a()}function a(){var n=jQuery("#"+r+" div.o_group_colors a.active"),
u="rgba(0,0,0,1.0)";0<n.length&&(u=n[0].getAttribute("data-color"));n=parseInt(jQuery("#"+r+" div.opacity_range_ui").slider("value"));100>n&&(n/=100,u=u.substring(0,u.lastIndexOf(",")),u+=","+n+")");return u}function c(n){var u=n.lastIndexOf(","),A=n.substring(0,u);jQuery("#"+r+" div.o_group_colors a").each(function(D,E){(D=E.getAttribute("data-color"))&&0==D.indexOf(A)?jQuery(E).addClass("active"):jQuery(E).removeClass("active")});n=Math.round(100*parseFloat(n.substring(u+1,n.length-1)));0<=n&&100>=
n&&jQuery("#"+r+" div.opacity_range_ui").slider("value",n)}function b(){var n=jQuery("#"+r+" div.width_range_ui").slider("value");0==n&&(n=1);return n/2}function d(n){0<=n&&100>=n&&jQuery("#"+r+" div.width_range_ui").slider("value",2*n)}function e(){y.clearRect(0,0,x.width,x.height);var n=b()/2,u=a(),A=x.width/2,D=n+1;y.beginPath();y.arc(A,D,n,0,2*Math.PI,!1);y.fillStyle=u;y.fill();if(0==u.indexOf("rgba(255,255,255,")||0==u.indexOf("#ff0000"))y.strokeStyle="#000000",y.lineWidth="1",y.stroke()}this.settings=
v.extend({inputHolderId:"",formDispatchFieldId:""},p);const g=this.settings.inputHolderId,q=this.settings.formDispatchFieldId;var r="paintw_"+g,k=new fabric.Canvas("paint_"+g,{isDrawingMode:!1,preserveObjectStacking:!0});fabric.Object.prototype.erasable=!0;fabric.Object.prototype.transparentCorners=!1;fabric.Object.prototype.cornerColor="#2980b9";fabric.Object.prototype.borderColor="#2980b9";var x=document.querySelector("#"+r+" canvas.brush_size"),y=x.getContext("2d");(function(){jQuery("#"+r+" div.o_group_tools a[data-tool\x3dselect]").on("click",
function(){m(this);k.isDrawingMode=!1;B()});jQuery("#"+r+" div.o_group_tools a[data-tool\x3dfront]").on("click",function(){k.isDrawingMode=!1;var n=k.getActiveObject();null!=n&&(n.bringToFront(),k.renderAll());B();h()});jQuery("#"+r+" div.o_group_tools a[data-tool\x3dback]").on("click",function(){k.isDrawingMode=!1;var n=k.getActiveObject();null!=n&&(n.sendToBack(),k.renderAll());B();h()})})();(function(){jQuery("#"+r+" div.o_group_tools a[data-tool\x3dtext]").on("click",function(){k.isDrawingMode=
!1;l();var n=a(),u=b();n=new fabric.Textbox("Hello",{left:35,top:20,fill:n,fontFamily:"helvetica",fontSize:Math.floor(2.5*u),originX:"left",hasRotatingPoint:!1,centerTransform:!0,strokeUniform:!0});k.add(n);n.bringToFront();k.setActiveObject(n)});jQuery("#"+r+" div.o_group_tools a[data-tool\x3dcircle]").on("click",function(){k.isDrawingMode=!1;l();var n=a(),u=b();n=new fabric.Circle({left:45,top:25,radius:65,originX:"left",fill:"rgba(255,255,255,0.0)",strokeWidth:u,stroke:n,hasRotatingPoint:!1,centerTransform:!0,
strokeUniform:!0});n.setControlsVisibility({ml:!1,mb:!1,mr:!1,mt:!1,mtr:!1});k.add(n);n.bringToFront();k.setActiveObject(n)});jQuery("#"+r+" div.o_group_tools a[data-tool\x3drectangle]").on("click",function(){k.isDrawingMode=!1;l();var n=a(),u=b();n=new fabric.Rect({left:50,top:30,width:50,height:50,originX:"left",fill:"rgba(255,255,255,0.0)",strokeWidth:u,stroke:n,hasRotatingPoint:!1,centerTransform:!0,strokeUniform:!0});k.add(n);n.bringToFront();k.setActiveObject(n)});jQuery("#"+r+" div.o_group_tools a[data-tool\x3dellipse]").on("click",
function(){k.isDrawingMode=!1;l();var n=a(),u=b();n=new fabric.Ellipse({left:15,top:10,rx:65,ry:35,fill:"rgba(255,255,255,0.0)",strokeWidth:u,stroke:n,hasRotatingPoint:!1,centerTransform:!0,strokeUniform:!0});k.add(n);n.bringToFront();k.setActiveObject(n)})})();(function(){jQuery("#"+r+" div.o_group_tools a[data-tool\x3deraser]").on("click",function(){m(this);k.isDrawingMode=!0;k.freeDrawingBrush=new fabric.EraserBrush(k);k.freeDrawingBrush.width=b()});jQuery("#"+r+" div.o_group_tools a[data-tool\x3dbrush]").on("click",
function(){m(this);k.isDrawingMode=!0;k.freeDrawingBrush=new fabric.PencilBrush(k);f()}).each(function(n,u){m(this)});jQuery("#"+r+" div.o_group_tools a[data-tool\x3dspray]").on("click",function(){m(this);k.isDrawingMode=!0;k.freeDrawingBrush=new fabric.SprayBrush(k);f()})})();(function(){jQuery("#"+r+" div.o_group_tools a[data-tool\x3dline]").on("click",function(){k.isDrawingMode=!1;m(this)});var n,u=!1;k.on("mouse:down",function(A){var D=jQuery("#"+r+" div.o_group_tools a.active");D=null!=D&&0!=
D.length?D[0].getAttribute("data-tool"):null;if(k.isDrawingMode)f();else if("line"===D){u=!0;D=a();var E=b();A=k.getPointer(A.e);n=new fabric.Line([A.x,A.y,A.x,A.y],{stroke:D,strokeWidth:E,originX:"center",originY:"center"});k.add(n)}});k.on("mouse:move",function(A){u&&(A=k.getPointer(A.e),n.set({x2:A.x,y2:A.y}),k.renderAll())});k.on("mouse:up",function(A){u&&(u=!1,k.discardActiveObject().renderAll(),B())})})();(function(){jQuery("#"+r+" div.width_range_ui").slider({min:1,max:100,value:20,change:function(n,
u){n=u.value/2;k.freeDrawingBrush.width=n;k.freeDrawingBrush.color=a();e();u=k.getActiveObject();null!=u&&("circle"===u.type||"rect"===u.type||"ellipse"===u.type?(u.set("strokeWidth",n),k.renderAll()):"textbox"===u.type&&(u.set("fontSize",n),k.renderAll()),B(),h());f()}});jQuery("#"+r+" div.opacity_range_ui").slider({min:1,max:100,value:100,change:function(n,u){n=a();k.freeDrawingBrush.width=b();k.freeDrawingBrush.color=n;e();u=k.getActiveObject();null!=u&&("circle"===u.type||"rect"===u.type||"ellipse"===
u.type?(u.set("stroke",n),k.renderAll()):"textbox"===u.type&&(u.set("fill",n),k.renderAll()),B(),h());f()}})})();(function(){jQuery("#"+r+" div.o_group_colors a").on("click",function(){jQuery("#"+r+" div.o_group_colors a").removeClass("active");jQuery(this).addClass("active");var n=a();k.freeDrawingBrush.color=n;var u=k.getActiveObject();null!=u&&("circle"===u.type||"rect"===u.type||"ellipse"===u.type?(u.set("stroke",n),k.renderAll()):"textbox"===u.type&&(u.set("fill",n),k.renderAll()));B();e();h()})})();
(function(){jQuery("#"+r+" a.clear").on("click",function(){var n=k.getActiveObject();null!=n&&(k.remove(n),k.renderAll());B();h()});jQuery("#"+r+" a.clearall").on("click",function(){var n=o_getMainWin();var u=n?jQuery(document).ooTranslator().getTranslator(n.o_info.locale,"org.olat.ims.qti21.ui"):{translate:function(D){return D}};n=u.translate("cancel");var A=u.translate("paint.erase");u='\x3cdiv id\x3d"paintModal" class\x3d"modal fade" tabindex\x3d"-1" role\x3d"dialog"\x3e  \x3cdiv class\x3d"modal-dialog" role\x3d"document"\x3e    \x3cdiv class\x3d"modal-content"\x3e      \x3cdiv class\x3d"modal-body"\x3e        \x3cp\x3e'+
(u.translate("paint.erase.hint")+"\x3c/p\x3e      \x3c/div\x3e");u=u+'      \x3cdiv class\x3d"modal-footer"\x3e        \x3cbutton type\x3d"button" class\x3d"btn btn-default" data-dismiss\x3d"modal"\x3e'+(n+'\x3c/button\x3e        \x3cbutton type\x3d"button" class\x3d"btn btn-primary" data-dismiss\x3d"modal"\x3e')+(A+"\x3c/button\x3e");u+="      \x3c/div\x3e";u+="    \x3c/div\x3e";u+="  \x3c/div\x3e";u+="\x3c/div\x3e";jQuery("body").append(u);jQuery("#paintModal").modal("show");jQuery("#paintModal button.btn-primary").on("click",
function(){k.clear();try{k.getObjects();jQuery("#op_"+g+"_png").val("");var D=JSON.stringify(k);jQuery("#op_"+g+"_json").val("data:application/json;base64,"+D)}catch(E){window.console&&console.log(E)}h()});jQuery("#paintModal").on("hidden.bs.modal",function(D){jQuery("#paintModal").remove()});o_scrollTop()})})();var z=jQuery("#op_"+g+"_json").val();t="undefined"!=typeof z&&0<z.length;p=null;t&&(p=JSON.parse(z));try{var C=z&&null!=p&&p.objects&&0<p.objects.length}catch(n){window.console&&console.log(n),
C=!1}C?(m(jQuery("#"+r+" div.o_group_tools a[data-tool\x3dselect]")[0]),k.isDrawingMode=!1):(m(jQuery("#"+r+" div.o_group_tools a[data-tool\x3dbrush]")[0]),jQuery("#"+r+" div.o_group_colors a.blue").addClass("active"),k.isDrawingMode=!0,k.freeDrawingBrush.width=b(),k.freeDrawingBrush.color=a());e();C=function(n){n=n.target;if("textbox"===n.type)c(n.fill),d(n.fontSize);else if("circle"===n.type||"rect"===n.type||"ellipse"===n.type)c(n.stroke),d(n.strokeWidth)};k.on("selection:created",C);k.on("selection:updated",
C);var B=function(){try{k.getObjects();var n=k.toDataURL("png");jQuery("#op_"+g+"_png").val(n);var u=JSON.stringify(k);jQuery("#op_"+g+"_json").val("data:application/json;base64,"+u)}catch(A){window.console&&console.log(A)}};k.on("object:modified",B);k.on("object:added",B);k.on("object:removed",B);k.on("mouse:out",B);t&&k.loadFromJSON(p,function(){k.renderAll()},function(n,u){u.isType("circle")&&u.setControlsVisibility({ml:!1,mb:!1,mr:!1,mt:!1,mtr:!1})});k.on("object:modified",h);k.on("object:added",
h);k.on("object:removed",h)}})(jQuery);