/*
	See https://www.tinymce.com/docs/advanced/boilerplate-content-css/
*/

@use "sass:list";

/* Image captions using the HTML5 figure element */
figure.align-left {
    float: left;
}

figure.align-right {
    float: right;
}

figure.image {
    display: inline-block;
    border: 1px solid gray;
    margin: 0 2px 0 1px;
    background: #f5f2f0;
}

figure.image img {
    margin: 8px 8px 0 8px;
}

figure.image figcaption {
    margin: 6px 8px 6px 8px;
    text-align: center;
}

/*
 Alignment using classes rather than inline styles
 check out the "formats" option
*/
img.align-left {
    float: left;
}

img.align-right {
    float: right;
}

/* Basic styles for Table of Contents plugin (toc) */
.tox-toc {
    border: 1px solid gray;
}

.tox-toc h2 {
    margin: 4px;
}

.tox-toc li {
    list-style-type: none;
}

// override the label in _forms.scss of bootstrap
label.mce-label {
  	display: inline;
	max-width: 150px;
	margin-bottom: 0;
	font-weight: normal;
}

.o_richtext_mce_without_path {
	.tox-statusbar {
		border: none;
	}

	.tox-statusbar__path {
    	display: none !important;
	}
	
	.tox-menubtn.tox-fixed-width span {
		width: auto;
	}
}

.o_richtext_mce>.o_richtext_mce_modes {
	text-align: right;
	padding-right: $input-border-radius;
	a {
		border-bottom: none;
		border-bottom-left-radius: 0;
		border-bottom-right-radius: 0;
	}
}


.o_htmleditor .o_richtext_mce .tox.tox-tinymce {
	border-top-left-radius: 0;
	border-top-right-radius: 0;
}

i.mce-ico.mce-i-help {
	@include o-add-icon('question-circle');
	@include o-add-icon-font();
	&:before {
		color: white;
	}	
}

.tox .tox-statusbar {

	&.danger .o_char_count {
		@include o-add-icon('exclamation-circle');
		@include o-add-icon-font();
		&:before {
			color: $brand-danger;
		}	
	}

	&.danger {
		background-color: $alert-danger-bg;
	}

	.o_char_count {
		@include o-add-icon('question-circle');
		@include o-add-icon-font();
		&:before {
			display: inline-block;
			margin-right: 5px;
		}	
	}
}

.tox-textbox.danger {
	border-color: darken($alert-danger-bg, 25%);
	background-color: $alert-danger-bg;
}

body .modal #o_link_chooser .container-fluid {
	@include container-fixed;
}

.tox .tox-form .tox-listboxfield .tox-listbox--select:focus,
.tox .tox-form .tox-textarea:focus,
.tox .tox-form .tox-textfield:focus {
	@include form-control-focus;
}

.tox .tox-form label.tox-label {
	font-family: $font-family-base;
	font-size: $font-size-base;
	font-weight: bold;
	line-height: $line-height-base;
	color: $text-color;
}

.tox .tox-form .help-block {
	font-size: 12px;
	color: lighten($text-color, 25%);
}

/* To make our file chooser useable with long list of files */
body.tox-dialog__disable-scroll {
	overflow: scroll !important;
}

dialog.dialog .tox .tox-dialog-wrap__backdrop {
	background: none;
}

// Limit modal in dialogs
dialog.dialog .tox-dialog.tox-dialog--width-lg {
	max-width: calc($modal-lg - 20px);
}


// Show ok / cancel button on very small devices
@media (max-width: 470px) {
	.mce-foot {
		.mce-container-body.mce-abs-layout {
			left: -337px;
		}
	}
}

.o_richtext_mce .tox {
	&.tox-tinymce {
		border: 1px solid $input-border;
  		border-radius: $input-border-radius;
	}
	
	.tox-toolbar__group {
		padding: 0 5px 0 6px;
	}

	.tox-promotion {
		display: none;
	}
}

/* END tiny defaults, now add OpenOLAT overrides and extensions */

/* add missing tiny styles */
figure.image {
	&.align-center {
		display: block;
		text-align: center;
	}
	&.align-left {
		float: none;
		display: block;
		text-align: left;
		figcaption {
			text-align: left;		
		}
	}
	&.align-right {
		float: none;
		display: block;
		text-align: right;
		figcaption {
			text-align: right;		
		}
	}
}

/* remove img styles when used within a figure element generated by tinymce */
figure.image {
	margin: 2em 0 2em 0;
    border: 0;
    background: none;

	img {
		&.b_float_left,
		&.b_float_left_clear,
		&.b_float_right,
		&.b_float_right_clear,
		&.b_float_left_clear_nomargin,
		&.b_centered {
			float: none; 
			display: inline-block;
			margin: 0;
		}
	}
	figcaption {
		font-size: 90%;
		font-style: italic;
	}
}

/* remove top margin for heading on top of the tinymce */
.mce-content-body {
	h1, h2, h3, h4, h5, h6 {
		&:first-child {
			margin-top: 0;
		}
	}
}

.mce-content-body {
	&.o_tiny_content_editor {
		&:not([dir=rtl])[data-mce-placeholder]:not(.mce-visualblocks)::before {
			left: 1.55em;
			color: $input-color-placeholder;
		}

		&:not([dir=rtl])[data-mce-placeholder]:not(.mce-visualblocks)::after {
			color: $input-color-placeholder;
			width: 1.25em;
			text-align: center;
			position: absolute;
			top: 0;
			font-family: $fa-style-family;
			font-weight: 900;
			-webkit-font-smoothing: antialiased;
		}

		&.o_text_editor {
			&:not([dir=rtl])[data-mce-placeholder]:not(.mce-visualblocks)::after {
				content: "#{$fa-var-align-left}";
			}
		}

		&.o_title_editor {
			font-weight: 500;
			line-height: 1.1;
			
			p {
				margin: 0;
			}

			&:not([dir=rtl])[data-mce-placeholder]:not(.mce-visualblocks)::after {
				content: "#{$fa-var-header}";
			}

			&.o_title_size_1 { font-size: $font-size-h1; }
			&.o_title_size_2 { font-size: $font-size-h2; }
			&.o_title_size_3 { font-size: $font-size-h3; }
			&.o_title_size_4 { font-size: $font-size-h4; }
			&.o_title_size_5 { font-size: $font-size-h5; }
			&.o_title_size_6 { font-size: $font-size-h6; }
		}
	}
}

